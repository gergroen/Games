@page "/tanks"
@using Games.Models.Tanks

<h3>Tank Battle</h3>
<div id="tankGameContainer" class="tank-game-container">
    <div class="hud-hp">
        @{
            var enemy = Battlefield.Enemies.FirstOrDefault();
            var enemyHp = enemy?.Hp ?? 0;
        }
        Player HP: @Battlefield.Player.Hp | Enemy HP: @enemyHp
        @if (!_running && (Battlefield.Player.Hp <= 0 || Battlefield.EnemiesRemaining == 0))
        {
            <button class="btn btn-sm btn-primary ms-2" @onclick="Restart">Play Again</button>
        }
        <button class="btn btn-sm btn-secondary ms-2" @onclick="ToggleFullscreen">Fullscreen</button>
    </div>
    <canvas id="tankCanvas" width="@Battlefield.GameWidth" height="@Battlefield.GameHeight"
        style="background:#222;border:2px solid #555;max-width:100%;"></canvas>
    <div class="control-overlay">
        <div class="joystick-wrapper">
            <div id="moveJoystick" class="joystick">
                <div class="stick"></div>
            </div>
        </div>
        <div class="joystick-wrapper right">
            <button class="ctrl-btn small auto @( _autoFire ? "on" : "off")" @onclick="ToggleAutoFire">
                @(_autoFire ? "AUTO ON" : "AUTO OFF")
            </button>
            @if (!_autoFire)
            {
                <button class="ctrl-btn fire" @onmousedown="StartFire" @onmouseup="StopFire" @onmouseleave="StopFire"
                    @ontouchstart="StartFire" @ontouchend="StopFire" @onclick="ManualFire">FIRE</button>
            }
            <div id="aimJoystick" class="joystick">
                <div class="stick"></div>
            </div>
        </div>
    </div>
</div>

@code {
    // Logic in partial code-behind Tanks.razor.cs
}
