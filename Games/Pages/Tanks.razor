@page "/tanks"
@using Games.Models.Tanks

<div id="tankGameContainer" class="tank-game-container">
    <div class="hud-hp">
        Player HP: @Battlefield.Player.Hp | Level: @Battlefield.Player.Level | XP: @Battlefield.Player.Xp/@Battlefield.GetXpForNextLevel() | Enemies: @Battlefield.EnemiesRemaining
        @if (Battlefield.Player.ShieldTime > 0)
        {
            <span class="badge bg-primary ms-2">üõ°Ô∏è @((int)Battlefield.Player.ShieldTime)s</span>
        }
        @if (Battlefield.Player.FirePowerTime > 0)
        {
            <span class="badge bg-danger ms-2">üî´ @((int)Battlefield.Player.FirePowerTime)s</span>
        }
        @if (Battlefield.Player.SpeedBoostTime > 0)
        {
            <span class="badge bg-warning ms-2">‚ö°Ô∏è @((int)Battlefield.Player.SpeedBoostTime)s</span>
        }
        <button class="btn btn-sm btn-primary ms-2 btn-icon" @onclick="Restart" title="Restart"
            aria-label="Restart">&#x21bb;</button>
        <button class="btn btn-sm btn-secondary ms-2 btn-icon" @onclick="ToggleFullscreen" title="Fullscreen"
            aria-label="Fullscreen">&#x26F6;</button>
    </div>
    <div class="radar-container">
        <div class="radar-title">RADAR</div>
        <canvas id="radarCanvas" width="120" height="120"></canvas>
    </div>
    <canvas id="tankCanvas" width="@Battlefield.GameWidth" height="@Battlefield.GameHeight"
        style="background:#222;border:2px solid #555;max-width:100%;"></canvas>
    <div class="control-overlay">
        <div class="joystick-wrapper">
            <div id="moveJoystick" class="joystick">
                <div class="stick"></div>
            </div>
        </div>
        <div class="joystick-wrapper right">
            <button class="ctrl-btn small auto @( _autoFire ? "on" : "off")" @onclick="ToggleAutoFire"
                @ontouchstart="ToggleAutoFire">
                @(_autoFire ? "AUTO ON" : "AUTO OFF")
            </button>
            @if (!_autoFire)
            {
                <button class="ctrl-btn fire" @onmousedown="StartFire" @onmouseup="StopFire" @onmouseleave="StopFire"
                    @ontouchstart="StartFire" @ontouchend="StopFire" @onclick="ManualFire">FIRE</button>
            }
            <div id="aimJoystick" class="joystick">
                <div class="stick"></div>
            </div>
        </div>
    </div>
</div>

@code {
    // Logic in partial code-behind Tanks.razor.cs
}
